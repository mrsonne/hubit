components:

  # First tank
  - path: ./components/mod1.py 
    context:
      IDX_TANK: 0
    provides_results:
      - name: vol_outlet_flow
        path: sites[IDX_SITE].lines[IDX_LINE].tanks[IDX_TANK].vol_outlet_flow
      - name: vol_over_flow
        path: sites[IDX_SITE].lines[IDX_LINE].tanks[IDX_TANK].vol_over_flow
    consumes_input:
      # use global inlet flow
      - name: tank_parameters
        path: sites[IDX_SITE].lines[IDX_LINE].tanks[IDX_TANK]
      - name: vol_inlet_flow
        path: vol_inlet_flow

  # # Second tank
  - path: ./components/mod1.py
    context:
      IDX_TANK: 1
    provides_results:
      - name: vol_outlet_flow
        path: sites[IDX_SITE].lines[IDX_LINE].tanks[IDX_TANK].vol_outlet_flow
      - name: vol_over_flow
        path: sites[IDX_SITE].lines[IDX_LINE].tanks[IDX_TANK].vol_over_flow
    consumes_input:
      - name: tank_parameters
        path: sites[IDX_SITE].lines[IDX_LINE].tanks[IDX_TANK]
    consumes_results:
      # use offset to subscribe to the outlet flow from previous tank 
      # as the inlet flow to the current tank
      - name: vol_inlet_flow
        path: sites[IDX_SITE].lines[IDX_LINE].tanks[IDX_TANK-1].vol_outlet_flow

  # Third tank
  - path: ./components/mod1.py
    context:
      IDX_TANK: 2
    provides_results:
      - name: vol_outlet_flow
        path: sites[IDX_SITE].lines[IDX_LINE].tanks[IDX_TANK].vol_outlet_flow
      - name: vol_over_flow
        path: sites[IDX_SITE].lines[IDX_LINE].tanks[IDX_TANK].vol_over_flow
    consumes_input:
      - name: tank_parameters
        path: sites[IDX_SITE].lines[IDX_LINE].tanks[IDX_TANK]
    consumes_results:
      # use offset to subscribe to the outlet flow from previous tank 
      # as the inlet flow to the current tank
      - name: vol_inlet_flow
        path: sites[IDX_SITE].lines[IDX_LINE].tanks[IDX_TANK-1].vol_outlet_flow
